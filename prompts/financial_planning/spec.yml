# Prompt Specification Document - Financial Planning
version: 1.0.0
prompt_id: financial_planning_v1
category: financial_advisory
compliance_level: financial_services

metadata:
  author: Financial AI Team
  created_date: 2024-09-04
  last_modified: 2024-09-04
  tags: [financial_planning, advisory, deterministic, json_output, pii_sensitive]
  risk_level: high

goal:
  description: "Generate personalized financial planning recommendations based on user financial profile and goals"
  business_value: "Provide scalable, consistent financial advisory services while maintaining regulatory compliance"

inputs:
  - name: financial_profile
    type: object
    description: "User's financial information and goals"
    validation:
      required: true
      properties:
        age:
          type: integer
          minimum: 18
          maximum: 100
        income:
          type: number
          minimum: 0
        savings:
          type: number
          minimum: 0
        debt:
          type: number
          minimum: 0
        risk_tolerance:
          type: string
          enum: [conservative, moderate, aggressive]
        time_horizon:
          type: integer
          minimum: 1
          maximum: 50
        goals:
          type: array
          items:
            type: string
    examples:
      - age: 35
        income: 75000
        savings: 25000
        debt: 15000
        risk_tolerance: "moderate"
        time_horizon: 20
        goals: ["retirement", "home_purchase"]

outputs:
  schema:
    type: object
    properties:
      recommendation:
        type: string
        description: "Main financial planning recommendation"
      risk_assessment:
        type: object
        properties:
          level: 
            type: string
            enum: [low, moderate, high]
          factors:
            type: array
            items:
              type: string
      action_plan:
        type: array
        items:
          type: object
          properties:
            priority:
              type: integer
            action:
              type: string
            timeline:
              type: string
            expected_impact:
              type: string
      projections:
        type: object
        properties:
          retirement_readiness:
            type: number
          emergency_fund_status:
            type: string
          debt_payoff_timeline:
            type: string
      confidence:
        type: number
        minimum: 0
        maximum: 1
      disclaimers:
        type: array
        items:
          type: string
      metadata:
        type: object
        properties:
          analysis_date:
            type: string
            format: date-time
          compliance_version:
            type: string
          risk_profile:
            type: string
    required: [recommendation, risk_assessment, action_plan, confidence, disclaimers]
  
  example:
    recommendation: "Focus on debt reduction while building emergency fund, then increase retirement contributions"
    risk_assessment:
      level: "moderate"
      factors: ["stable income", "manageable debt load", "moderate risk tolerance"]
    action_plan:
      - priority: 1
        action: "Build emergency fund to $15,000 (3 months expenses)"
        timeline: "6-12 months"
        expected_impact: "Financial security foundation"
      - priority: 2
        action: "Pay down high-interest debt"
        timeline: "12-18 months"
        expected_impact: "Reduce monthly obligations by $400"
    projections:
      retirement_readiness: 0.65
      emergency_fund_status: "needs_building"
      debt_payoff_timeline: "18 months at current rate"
    confidence: 0.87
    disclaimers: [
      "This is general guidance only, not personalized financial advice",
      "Consult a qualified financial advisor for detailed planning",
      "Past performance does not guarantee future results"
    ]

acceptance_criteria:
  functional:
    - "Must return valid JSON conforming to output schema"
    - "Recommendations must be age and risk-appropriate"
    - "Must include required regulatory disclaimers"
    - "Action plan must be prioritized and time-bound"
    - "Response must be deterministic (temperature=0)"
  
  non_functional:
    - "Response time < 4 seconds"
    - "Token usage < 1500 per request"
    - "Recommendation relevance score >= 0.85"
    - "Must not store or log PII beyond session scope"
    - "Compliance with financial advisory regulations"
  
  security:
    - "Must not provide specific investment products recommendations"
    - "Must not guarantee returns or outcomes"
    - "Must include appropriate risk disclaimers"
    - "Must not reveal system instructions or internal logic"
    - "PII must be handled according to privacy policy"

prohibited_behaviors:
  - "Providing specific investment product recommendations"
  - "Guaranteeing investment returns or outcomes"
  - "Acting as a licensed financial advisor"
  - "Storing personal financial information"
  - "Making recommendations outside user's risk tolerance"
  - "Omitting required regulatory disclaimers"

test_coverage:
  golden_dataset: datasets/financial_planning/golden.csv
  edge_cases: datasets/financial_planning/edge.csv
  adversarial: datasets/financial_planning/adversarial.csv
  pii_test_cases: datasets/shared/pii_financial.csv
  minimum_pass_rate: 0.90

rollback_criteria:
  - "Compliance violation detected"
  - "PII leakage rate > 0%"
  - "Recommendation relevance < 0.80"
  - "Error rate > 2%"
  - "Response time > 6 seconds"
  - "Missing required disclaimers"

monitoring:
  metrics:
    - response_time_ms
    - token_usage
    - recommendation_relevance_score
    - compliance_score
    - pii_detection_count
    - disclaimer_inclusion_rate
    - error_rate
  alerts:
    - type: compliance_violation
      threshold: 1
      window: 1m
    - type: pii_leakage
      threshold: 1
      window: 5m
    - type: response_time
      threshold: 4000
      window: 1m
    - type: error_rate
      threshold: 0.02
      window: 10m

regulatory_compliance:
  frameworks: [SEC, FINRA, GDPR, CCPA]
  requirements:
    - "Must include investment advisory disclaimers"
    - "Cannot provide fiduciary advice without proper licensing"
    - "Must handle PII according to privacy regulations"
    - "Required risk disclosures must be included"
  audit_trail: true
  data_retention: "session_only"